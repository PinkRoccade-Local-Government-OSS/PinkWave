"""
Checks path traversal payloads like ../ or ../../etc/passwd
"""
__author__ = "Maarten Schermer"

import sys
from os import walk
from os.path import dirname,abspath,isfile

# Importing PinkWave extensions
sys.path.append(dirname(dirname(dirname(abspath(__file__)))))
from extensions.Util import Util,report,payloads
import extensions.Request as Request

# (Optional) Specify label list
def labels():
    return ['A6 - Sensitive Data Exposure']

def options():
    return ['target','requestNames','request']

def start(pentest):
    for payload in payloads("linuxpathtraversal",__file__):
        Request.do(pentest,payload)
        if "root:/root" in pentest.browser.text():
            report("Path traversal detected (%s)" % payload)
