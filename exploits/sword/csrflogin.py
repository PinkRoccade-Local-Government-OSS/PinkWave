"""
Try to login via a direct POST request to test for CSRF vulnerabilities
"""
__author__ = "Maarten Schermer"

import sys
from os.path import dirname,abspath

# Importing PinkWave extensions
sys.path.append(dirname(dirname(dirname(abspath(__file__)))))
from extensions.Util import Util,report,payloads
from lib.Browser import NoSuchElementException
import extensions.Request as Request

# (Optional) Specify label list
def labels():
    return ['A8 - Cross-Site Request Forgery (CSRF)']

def options():
    return ['target','requestNames','creds']

def start(pentest):
    Request.directpost(pentest.target,pentest.requestNames,pentest.creds)
    for formname in pentest.requestNames:
        try:
            pentest.browser.getElementByName(formname)
        except NoSuchElementException:
            report("Logged In with direct POST")
