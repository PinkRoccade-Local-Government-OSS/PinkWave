"""
Scans HTTP port and tests if HSTS header is present
"""
__author__ = "sword"

import sys
from os.path import dirname,abspath

# Importing PinkWave extensions
sys.path.append(dirname(dirname(dirname(abspath(__file__)))))
from extensions.Util import Util,report,payloads
import extensions.Http as Http

def labels():
    return ['A5 - Security Misconfiguration']

def options():
    return ['target']

def start(pentest):
    import time
    result = Http.has_header(pentest.target, "Strict-Transport-Security")
    if result is False:
        report("No HSTS header to prevent sslstripping")
