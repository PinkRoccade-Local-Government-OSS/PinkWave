"""
Performs SQL injection payloads on selected form,
Looks for the string "error"
"""
__author__ = "sword"

import sys,os
from os.path import dirname,abspath

# Importing PinkWave extensions
sys.path.append(dirname(dirname(dirname(abspath(__file__)))))
from extensions.Util import Util,report,payloads
import extensions.Request as Request

def labels():
    return ['A1 - Injection']

def options():
    return ['target','requestNames','request']

def start(pentest):
    for payload in payloads("sql",__file__):
        r = Request.do(pentest,payload)
        if " error " in r.text:
            report("SQL injection based on ' error ' in text")
        elif r.time > 7:
            report("SQL injection based on timeout")
